<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Notre douce maison</title>
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: 'Cursive', serif;
      overflow: hidden;
    }
    .background {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      z-index: -1;
      overflow: hidden;
    }
    .background img {
      position: absolute;
      width: 100%; height: 100%;
      object-fit: cover;
      opacity: 0;
      transition: opacity 3s ease-in-out;
    }
    .active { opacity: 1; }

    .page {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100%;
      width: 100%;
      text-align: center;
      font-size: 3rem;
      color: white;
      background: rgba(0,0,0,0.4);
      transition: opacity 2s;
    }
    .hidden { display: none; }

    .enigme {
      font-family: 'Brush Script MT', cursive;
      font-size: 3.5rem;
      margin-bottom: 40px;
    }
    input {
      padding: 25px;
      font-size: 2rem;
      margin-bottom: 30px;
      text-align: center;
    }
    button {
      padding: 20px 50px;
      margin-left: 10px;
      font-size: 2rem;
      cursor: pointer;
    }
    .fade-out {
      opacity: 0;
      transition: opacity 5s ease;
    }

    .swiper {
      width: 100%;
      height: 100%;
    }
    .swiper-slide {
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
      color: white;
      background: rgba(0,0,0,0.4);
      font-size: 2rem;
    }
    .swiper-slide > div {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100%;
      width: 100%;
    }

    /* Écran noir pour la transition */
    #blackout {
      position: fixed;
      top:0;left:0;
      width:100%;height:100%;
      background:black;
      opacity:0;
      pointer-events:none;
      transition: opacity 5s ease;
      z-index: 9999;
    }
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
</head>
<body>
  <div class="background"></div>
  <div id="blackout"></div>

  <div id="accueil" class="page">
    <h1>Notre douce maison</h1>
  </div>

  <div class="swiper hidden" id="enigmes">
    <div class="swiper-wrapper" id="swiper-wrapper"></div>
    <div class="swiper-pagination"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script>
    const bgContainer = document.querySelector('.background');
    const baseURL = "https://thesamestoy.github.io/homesweethome/images/";

    // Image accueil
    const accueilImg = document.createElement('img');
    accueilImg.src = baseURL + "Accueil.jpg";
    accueilImg.classList.add('active');
    bgContainer.appendChild(accueilImg);

    // Images pour le slideshow des énigmes
    const letters = "abcdefghijklmnopqrstuvw";
    const images = letters.split('').map(l => baseURL + l + ".jpg");

    // Après 5s -> cacher accueil et afficher énigmes + slideshow
    setTimeout(() => {
      document.getElementById('accueil').style.opacity = 0;
      setTimeout(() => {
        document.getElementById('accueil').classList.add('hidden');
        document.getElementById('enigmes').classList.remove('hidden');

        let img1 = document.createElement('img');
        let img2 = document.createElement('img');
        bgContainer.appendChild(img1);
        bgContainer.appendChild(img2);

        let currentIndex = Math.floor(Math.random() * images.length);
        img1.src = images[currentIndex];
        img1.classList.add("active");

        setInterval(() => {
          let nextIndex;
          do { nextIndex = Math.floor(Math.random() * images.length); }
          while (nextIndex === currentIndex);
          currentIndex = nextIndex;

          img2.src = images[currentIndex];
          img2.classList.add("active");
          img1.classList.remove("active");

          const tmp = img1;
          img1 = img2;
          img2 = tmp;
        }, 5000);

      }, 2000);
    }, 5000);

    // Liste des énigmes
    const data = [
      { question: "Sans être délice<br>Je ne suis pas laid<br>Retrouvez moi six fois<br>Autour d'un café", reponse: 'Lait' },
      { question: "<span style='color:red; text-decoration: line-through;'>356</span> - 47 - 007 - 701<br>Nous sommes premiers<br>mais le dernier<br>ne l'est pas", reponse: 'Zéro' },
      { question: "Contre vents et marées<br>Et vos milles averses<br>Je suis l'inamovible guide<br>The silent partner", reponse: 'Phare' },
      { question: "La première flèche indique l'entrée<br>Et la seconde ?", reponse: 'Thonier' },
      { question: "Fuyez nemesis<br>Résolvez le puzzle<br>l'échelle de H470-H485-H490-H580-H600<br> mène au céleste secret", reponse: 'Balance' },
      { question: "Exotique gardien<br>je veille au brin du jour<br>l'Enigma enfantin<br>27 lettres d'amour", reponse: 'Toucan' },
      { question: "Trouvez l'équation<br>et faites que s'illumine<br>non pas 3x<br> mais le chiffre solution", reponse: 'Set' },
      { question: "Pays de l'est<br>Parfois à l'WEST<br>Trouvez-moi au Sud Est<br>A 1,5 mètre.", reponse: 'Germany' },
      { question: "Trouvez l'oeil venu du froid<br>Iris de métal<br>Regardez moi poser fièrement<br>En tout temps et toutes saison", reponse: 'Oiseau' },
      { question: "Nous sommes deux fleurs sans couleurs<br>Regarde nous de près <br>d'encore plus près<br>Et complète le 100%", reponse: 'Danger' }
    ];

    // Ajouter la 11ème énigme spéciale
    const finalEnigma = { 
      question: "La dernière clé<br>se cache discrète<br>Ouvre-moi<br>par une ...", 
      reponse: 'Parenthèse' 
    };

    const wrapper = document.getElementById('swiper-wrapper');

    // Fonction qui construit une énigme
    function buildEnigme(enigme, idx, isFinal=false) {
      const slide = document.createElement('div');
      slide.classList.add('swiper-slide');

      const content = document.createElement('div');
      slide.appendChild(content);

      const q = document.createElement('div');
      q.className = 'enigme';
      q.innerHTML = enigme.question;
      content.appendChild(q);

      const input = document.createElement('input');
      input.type = 'text';
      input.id = 'input-'+idx;
      content.appendChild(input);

      const button = document.createElement('button');
      button.innerText = 'Valider';
      content.appendChild(button);

      const result = document.createElement('div');
      result.style.fontSize = "2rem";
      result.style.marginTop = "20px";
      content.appendChild(result);

      const saved = localStorage.getItem('enigme'+idx);
      if(saved){
        q.style.display = 'none';
        input.style.display = 'none';
        button.style.display = 'none';
        result.innerHTML = `La bonne réponse est bien<br><strong>${saved}</strong>`;
      }

      button.addEventListener('click', () => {
        if(input.value.trim().toLowerCase() === enigme.reponse.toLowerCase()){
          localStorage.setItem('enigme'+idx, input.value.trim());
          q.classList.add('fade-out');
          input.classList.add('fade-out');
          button.classList.add('fade-out');

          setTimeout(() => {
            q.style.display = 'none';
            input.style.display = 'none';
            button.style.display = 'none';
            result.innerHTML = `La bonne réponse est bien<br><strong>${enigme.reponse}</strong>`;
          }, 5000);

          // Si c'était la dernière des 10 -> lancer transition vers page finale
          if(!isFinal && idx === data.length-1){
            setTimeout(() => {
              document.getElementById('blackout').style.opacity = 1;
              setTimeout(() => {
                swiper.slideTo(data.length); // aller à l'énigme finale
                document.getElementById('blackout').style.opacity = 0;
              }, 5000);
            }, 1000);
          }

        } else {
          alert('Mauvaise réponse');
        }
      });

      wrapper.appendChild(slide);
    }

    // Générer les 10 énigmes
    data.forEach((enigme, idx) => buildEnigme(enigme, idx));

    // Générer la 11ème énigme (page noire finale)
    buildEnigme(finalEnigma, data.length, true);

    const swiper = new Swiper('.swiper', {
      direction: 'vertical',
      pagination: { el: '.swiper-pagination', clickable: true },
      mousewheel: true,
      keyboard: true
    });
  </script>
</body>
</html>
